# <center>加密与压缩</center>
## <center>目录</center>
1. **用户视角的应用**
  - 见"策划.md"
2. **程序概览**
  - 见"策划.md"

3. **程序结构初步设计**
  - 3.1 基本结构
  - 3.2 初步设计
  
4. **底层细节与技术**
  - 4.1 技术的整合与分析
  -
5. **算法具体实现**
  - 5.1 实现方案
  - 5.2 疑难问题的解决方案
  - 5.3 优化与改进

6. **安全问题**
7. **最终实现**


### 3. 程序结构初步设计
# 3.1 程序结构

**Encryption/Decryption_System**
    负责加密与解密工作，与压缩端以二进制数据进行通信。

    需要打包为线程。

**Compress/Decompress_System**
    负责压缩与解压。

    需要打包为线程。

**BufferPool**
    缓存以上两者的输出，充当一个可接受线程动态调度（如TM对文件完整性的检测）的对象。

    为此，需要编写一个虚拟接口，以此适配各个算法的输入。

    暂定为每个线程组独立使用一个缓存池

    仅充当被调度对象

**ThreadManager**
    负责在线程尺度下调度由加密算法以及压缩算法的相关线程（一级线程）

    若引入多线程，需要另外设计管理逻辑，用于管理二级线程

**ErrorCollector**
    负责对错误的检测与收集，生成并且输出相关错误报告（日志）


# 3.2 初步设计
**Aes**
    技术点（适配技术）：

        1、密钥hash处理

        2、尾部补全与去除

        3、缓存池

        （全部已完成）

**Heffman**
        1、希望所有即将引入的压缩算法能整合多文件为单文件并输出
        2、
        3、


**Combination**
示意：Heffman-(1)>Aes-(2)>.sy文件（实际为二进制）

    1、单流程：模块化的独立线程处理
            I:线程管理
                将heffman与aes作为单独线程，两者交由一个更高级的线程进行管理

                加密和压缩作为独立模块，通过任务队列连接。

                使用无锁队列或批量传输减少同步开销。



                可优化：按照算法耗时管理线程并行数量

            II:io
                从缓冲池接收压缩端的输出，加密。

            III:方案的优点
                若引入抽象接口，可以支持未来的新增算法

                处理流程的高度可定义性

            IV:面临的问题
                复杂度高：需缓冲区管理、线程同步、流量控制

                缓冲区：缓冲区可能成为性能瓶颈（需无锁队列或环形缓冲区）

                调试困难：需处理跨线程异常和状态一致性


    2、多线程的管理
            I:文件分割的管理方法
                加密结束后依据预先传输的顺序表整合加密后的结果（文件分割后分配到流程、算法内分配线程任务，都需要处理顺序表的传输和读取）
            II:

    2、设计GUI：I：多线程模式选择（后续自动检测）。II：加密、压缩算法切换。III：引入已加密的标记与加密文件的自动识别、提示输入密码。

    3、优化：

        Aes：I：多线程：可能使用文件分割，需要注意内存和线程数检测。II：需要引入id标记分块文件，以便整合为文件输出。III：指令集加速。

        Heffman：I：多线程，部分同Aes

        Combination：I：串行多线程：将调用两个项目中已经做好封装的功能来创建线程 II：线程安全


## 4. 底层细节与技术
**4.1 技术的整合与分析**
    主要技术：
        加密：
            aes-128
        压缩：
            heffman
        控制：
            thread/buffer
    分析：
        加密：
            aes-128：目前采用128bit密钥，十轮处理的aes算法进行加密
        压缩：
            heffman基于自然语言重复性的压缩算法
        控制：
            thread/buffer:
                线程与线程、线程与缓存池之间的组合与调度。
                难点在于ThreadManager的实现



## 5. 算法具体实现
**5.1 实现方案** 
**5.2 疑难问题的解决方案**
**5.3 优化与改进**